(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof module==="object"&&module.exports){module.exports=t()}else{e.Jroff=t()}})(this,function(){"use strict";var n=1,r=2,s=3,i=4,a=5,u=6,o=7;var t=["Ac","Ao","Bc","Bo","Brc","Bro","Dc","Do","Ec","Eo","Fc","Oc","Oo","Pc","Po","Qc","Qo","Sc","So","Xc","Xo","Aq","Bq","Brq","Dq","Op","Pq","Ql","Qq","Sq","Vt","Ta","Ad","An","Ap","Ar","At","Bsx","Bx","Cd","Cm","Dv","Dx","Em","Er","Ev","Fa","Fl","Fn","Ft","Fx","Ic","Li","Lk","Ms","Mt","Nm","Ns","Nx","Ox","Pa","Pf","Sx","Sy","Tn","Ux","Va","Vt","Xr"];var f={macro:/^\./,macroStart:/^.\s*/,lexeme:/(\n|\s+|^\.\s+\S+)/g,comment:/(\.)?\\\"|\\#/,arguments:/"(.*?)"|\S+/g,number:/[\d]/,realNumber:/(^[\-|\+]?\d)/,escape:/(\\[^\"])/g,wrappingQuotes:/^\s*?\"([^\"]*)\"\s*?$/g,noWhiteSpace:/\S/,newLine:/[ \t]*\n/};var c=function(e){return e.reduce(function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}return e},{})};var h=function(e){return[r,s,o].indexOf(e.kind)!==-1};var p={},l=null;var g=function(e,t){this.value=e||"";this.kind=t||u;this.nodes=[]};g.isComment=function(e){return f.comment.test(e)};g.isEmptyLine=function(e){return f.newLine.test(e)};g.isInlineMacro=function(e){return t.indexOf(e)!==-1&&l==="doc"};g.isMacro=function(e){return f.macro.test(e)};g.isEscape=function(e){return e.charAt(0)==="\\"};g.prototype.addNode=function(e){this.nodes.push(e);return this};g.prototype.lastNode=function(){return this.nodes[this.nodes.length-1]||new g};g.prototype.mix=function(e){this.value=this.value+e.value;if(this.kind===u){this.kind=e.kind}return this};var m=function(){};m.prototype.create=function(e){var t=a;if(typeof e==="undefined"){t=u}else if(g.isComment(e)){t=n}else if(g.isMacro(e)){t=r}else if(g.isInlineMacro(e)){t=s}else if(g.isEmptyLine(e)){t=i}else if(g.isEscape(e)){t=o}return new g(e,t)};var d=function(e){this.source=this.cleanSource(e).split(f.lexeme);this.tokens=[];this.sourceIdx=0;this.col=0;this.line=1;this.factory=new m};d.prototype.cleanSource=function(e){return e.replace(f.escape," $1 ").replace(/</g,"&lt;").replace(/>/g,"&gt;")};d.prototype.lex=function(){var e;while(typeof(e=this.next())!=="undefined"){this.tokens.push(this.factory.create(e))}return this.tokens};d.prototype.next=function(){var e=this.source[this.sourceIdx++];if(e==="\n"){this.col=0;this.line+=1}else if(e){this.col+=e.length}return e};var T=function(e){this.ast=[];this.scope=this.ast;this.lexer=new d(e);this.tokens=this.lexer.lex();this.lastTok=new g("",i);this.escapeWithArguments=["\\f","\\s","\\m","\\("];this.mappings={};this.mappings[r]="handleMacro";this.mappings[s]="setNewScope";this.mappings[a]="handleText";this.mappings[o]="handleEscape";this.mappings[i]="handleBreak";this.mappings[n]="ignore";this.mappings[u]="ignore"};T.prototype.next=function(){return this.tokens.shift()};T.prototype.addToScope=function(e){this.scope.push(e);this.lastTok=e};T.prototype.buildAST=function(){var e;while(e=this.next()){this[this.mappings[e.kind]](e)}return this.ast};T.prototype.handleMacro=function(e){if(this.lastTok.kind===i){e.value=e.value.replace(f.macroStart,"");this.setNewScope(e)}else{this.handleText(e)}};T.prototype.setNewScope=function(e){this.addToScope(e);this.scope=e.nodes};T.prototype.handleBreak=function(e){this.scope=this.ast;if(this.lastTok.kind===i){this.scope.push(new g("br",r))}else{this.scope.push(new g(" ",a))}this.lastTok=e};T.prototype.handleEscape=function(e){if(this.escapeWithArguments.indexOf(e.value)!==-1){var t;this.next();t=this.next();t.kind=a;e.nodes.push(t)}this.addToScope(e)};T.prototype.handleText=function(e){if(!e.value){return}e.kind=a;if(this.lastTok.kind===a){this.lastTok.mix(e)}else{if(h(this.lastTok)){e.value=e.value.trim()}this.addToScope(e)}};T.prototype.ignore=function(e){this.scope=[];this.lastTok=e};p.an={TH:function(e){var t;e=this.parseArguments(e);this.buffer.title=e[0]||"";this.buffer.section=e[1]||"";this.buffer.date=e[2]||"";this.buffer.source=e[3]||"";this.buffer.manual=e[4]||"";t=this.buffer.title+"("+this.buffer.section+")";return"<p><span>"+t+"</span>"+"<span>"+this.buffer.manual+"</span>"+"<span>"+t+"</span></p>"},SH:function(e){var t='<section style="margin-left:'+this.buffer.style.indent+'%;">',n="";this.buffer.section=e;n+=this.closeAllTags(this.buffer.fontModes);n+=this.closeAllTags(this.buffer.openTags);n+=this.closeAllTags(this.buffer.sectionTags);this.buffer.sectionTags.push("section");return n+this.generateTag("h2",e)+t},SS:function(e){return this.generateTag("h3",e)},B:function(e){return this.generateTag("strong",e)},BI:function(e){return this.generateAlternTag("strong","i",e)},BR:function(e){return this.generateAlternTag("strong","span",e)},I:function(e){return this.generateTag("i",e)},IB:function(e){return this.generateAlternTag("i","strong",e)},IR:function(e){return this.generateAlternTag("i","span",e)},RB:function(e){return this.generateAlternTag("span","strong",e)},RI:function(e){return this.generateAlternTag("span","i",e)},SB:function(e){return this.generateAlternTag("small","strong",e)},SM:function(e){return this.generateTag("small",e)},P:function(){var e="";e+=this.closeAllTags(this.buffer.fontModes);e+=this.closeTagsUntil("div",this.buffer.openTags);this.buffer.openTags.push("div");return e+'<div style="margin-bottom: 2%;">'},RS:function(e){var t="";e=e||this.buffer.style.indent;t+=this.closeAllTags(this.buffer.fontModes);t+='<section style="margin-left:'+e+'%">';this.buffer.openTags.push("section");return t},RE:function(){return this.closeTagsUntil("section",this.buffer.openTags)}};p.an.LP=p.an.P;p.an.PP=p.an.P;var b={B:"strong",R:"span",I:"i",S:"small"};p.defaults={br:function(){return"<br>"},ss:function(e){this.buffer.openTags.push("span");return'<span style="word-spacing:'+e/36+'em;">'},ft:function(e){var t="",n;e=this.parseArguments(e)[0];n=b[e.trim()];t+=this.closeAllTags(this.buffer.fontModes);if(n!==b.R){t+="<"+n+"> ";this.buffer.fontModes.push(n)}return t},vs:function(e){e=e||12;this.buffer.openTags.push("section");return'<section style="line-height:'+e/12+'em;">'},nf:function(){return"<br>"},in:function(e){e=e||3;this.buffer.openTags.push("section");return'<section style="margin-left:'+e/3+'em;">'},ul:function(){return p.defaults.ft.call(this,"I")},cu:function(){return p.defaults.ft.call(this,"I")},sp:function(e){e=e||"2";return'<hr style="margin-top:'+e+'em;visibility:hidden;">'},if:function(){return""},ie:function(){return""},el:function(){return""},"\\}":function(){return""},de:function(){return""},ne:function(){return""},".":function(){return""},fi:function(){return""},nh:function(){this.buffer.style.hyphens="none"},ad:function(e){this.buffer.style.textAlign=e},"\\\\":function(){return p.defaults["\\e"].call(this)},"\\e":function(){return"\\ "},"\\-":function(){return"&minus;"},"\\f":function(e){var t;e=e.trim();t=e.charAt(0);return p.defaults.ft.call(this,t)+" "+e.slice(1)},"\\&":function(){return""},"\\s":function(e){var t;e=e.split(f.realNumber);t=e[2]||"";this.buffer.style.fontSize+=parseInt(e[1],10);this.buffer.openTags.push("span");return'<span style="font-size:'+this.buffer.style.fontSize+'px;">'+t},"\\m":function(){return""},"\\(":function(){return""},"\\d":function(){return""},"\\u":function(){return""},"\\+":function(){return"&plus;"}};var S={1:"General Commands Manual",2:"System Calls Manual",3:"Library Functions Manual",4:"Kernel Interfaces Manual",5:"File Formats Manual",6:"Games Manual",7:"Miscellaneous Information Manual",8:"System Manager's Manual",9:"Kernel Developer's Manual"};var v={USD:"User's Supplementary Documents",PS1:"Programmer's Supplementary Documents",AMD:"Ancestral Manual Documents",SMM:"System Manager's Manual",URM:"User's Reference Manual",PRM:"Programmer's Manual",KM:"Kernel Manual",IND:"Manual Master Index",LOCAL:"Local Manual",CON:"Contributed Software Manual"};var I=["alpha","acorn26","acorn32","algor","amd64","amiga","arc","arm26","arm32","atari","bebox","cats","cesfic","cobalt","dreamcast","evbarm","evbmips","evbppc","evbsh3","hp300","hp700","hpcmips","i386","luna68k","m68k","mac68k","macppc","mips","mmeye","mvme68k","mvmeppc","netwinder","news68k","newsmips","next68k","ofppc","pc532","pmax","pmppc","powerpc","prep","sandpoint","sgimips","sh3","shark","sparc","sparc64","sun3","tahoe","vax","x68k","x86_64"];var y={"-emphasis":"i","-literal":"span","-symbolic":"strong"};var E={"-ansiC":"ANSI X3.159-1989 (``ANSI C89'')","-ansiC-89":"ANSI X3.159-1989 (``ANSI C89'')","-isoC":"ISO/IEC 9899:1990 (``ISO C90'')","-isoC-90":"ISO/IEC 9899:1990 (``ISO C90'')","-isoC-99":"ISO/IEC 9899:1999 (``ISO C99'')","-iso9945-1-90":"ISO/IEC 9945-1:1990 (``POSIX.1'')","-iso9945-1-96":"ISO/IEC 9945-1:1996 (``POSIX.1'')","-p1003.1":"IEEE Std 1003.1 (``POSIX.1'')","-p1003.1-88":"IEEE Std 1003.1-1988 (``POSIX.1'')","-p1003.1-90":"ISO/IEC 9945-1:1990 (``POSIX.1'')","-p1003.1-96":"ISO/IEC 9945-1:1996 (``POSIX.1'')","-p1003.1b-93":"IEEE Std 1003.1b-1993 (``POSIX.1'')","-p1003.1c-95":"IEEE Std 1003.1c-1995 (``POSIX.1'')","-p1003.1g-2000":"IEEE Std 1003.1g-2000 (``POSIX.1'')","-p1003.1i-95":"IEEE Std 1003.1i-1995 (``POSIX.1'')","-p1003.1-2001":"IEEE Std 1003.1-2001 (``POSIX.1'')","-p1003.1-2004":"IEEE Std 1003.1-2004 (``POSIX.1'')","-iso9945-2-93":"ISO/IEC 9945-2:1993 (``POSIX.2'')","-p1003.2":"IEEE Std 1003.2 (``POSIX.2'')","-p1003.2-92":"IEEE Std 1003.2-1992 (``POSIX.2'')","-p1003.2a-92":"IEEE Std 1003.2a-1992 (``POSIX.2'')","-susv2":"Version 2 of the Single UNIX Specification (``SUSv2'')","-susv3":"Version 3 of the Single UNIX Specification (``SUSv3'')","-svid4":"System V Interface Definition, Fourth Edition (``SVID4'')","-xbd5":"X/Open System Interface Definitions Issue 5 (``XBD5'')","-xcu5":"X/Open Commands and Utilities Issue 5 (``XCU5'')","-xcurses4.2":"X/Open Curses Issue 4, Version 2 (``XCURSES4.2'')","-xns5":"X/Open Networking Services Issue 5 (``XNS5'')","-xns5.2":"X/Open Networking Services Issue 5.2 (``XNS5.2'')","-xpg3":"X/Open Portability Guide Issue 3 (``XPG3'')","-xpg4":"X/Open Portability Guide Issue 4 (``XPG4'')","-xpg4.2":"X/Open Portability Guide Issue 4, Version 2 (``XPG4.2'')","-xsh5":"X/Open System Interfaces and Headers Issue 5 (``XSH5'')","-ieee754":"IEEE Std 754-1985","-iso8802-3":"ISO/IEC 8802-3:1989"};p.doc={Dt:function(e){var t,n,r,s,i;e=this.parseArguments(e);r=e[0];s=e[1];i=e[2];this.buffer.title=r||"UNTITLED";this.buffer.section=s||"";this.buffer.volume=i||"LOCAL";t=this.buffer.title;n=this.buffer.volume;if(s){t=this.buffer.title+"("+this.buffer.section+")";if(v[i]){n=v[i]}else if(I.indexOf(i)!==-1){n="BSD/"+i+S[this.buffer.section]}else if(S[this.buffer.section]){n="BSD"+S[this.buffer.section]}}return"<p><span>"+t+"</span>"+"<span>"+n+"</span>"+"<span>"+t+"</span></p><section>"},Dd:function(e){this.buffer.date=e},Os:function(e){this.buffer.os=e},Ad:function(e){return this.generateTag("i",e)},An:function(e){return this.generateTag("span",e)},Ar:function(e){e=e||"file...";return this.generateTag("i",e)},Cd:function(e){var t=this.isInsideOfSection("SYNOPSIS")?"p>strong":"strong";return this.generateTag(t,e)},Dv:function(e){return this.generateTag("span",e)},Ev:function(e){return this.generateTag("span",e)},Fl:function(e){return this.generateTag("strong","-"+e)},Cm:function(e){return this.generateTag("strong",e)},Nm:function(e){var t;this.buffer.name=this.buffer.name||e;t=e||this.buffer.name;return this.generateTag("strong",t)},Nd:function(e){return this.generateTag("span","-- "+e)},Sh:function(e){var t='<section style="margin-left:'+this.buffer.style.indent+'%;">';this.buffer.section=e;return"</section>"+this.generateTag("h2",e)+t},Op:function(e){return this.generateTag("span","["+e+"]")},Xr:function(e){var t,n,r;e=this.parseArguments(e);t=e.shift()||"";n=e[0]?"("+e.shift()+")":"";r=e.join(" ")||"";return this.generateTag("span",t+n+r)},Bl:function(e){var t;e=this.parseArguments(e);this.buffer.lists.unshift({flags:e,prevTag:"",isOpen:false});t=this.buffer.style.indent/4*(this.buffer.lists.length-1);return'<ul style="list-style:none;padding:0 0 0 '+t+'%;">'},It:function(e){var t=this.buffer.lists[0],n=t.isOpen?"</span></li>":"",r="",s="",i="margin-bottom:2%;";t.isOpen=true;for(var a=t.flags.length-1;a>=0;a--){switch(t.flags[a]){case"-bullet":s="&compfn;";i+="margin-left:2%;";break;case"-dash":s="&minus;";i+="margin-left:2%;";break;case"-enum":t.prevTag=t.prevTag||1;s=t.prevTag+++".";i+="margin-left:2%;";break;case"-item":s="";i+="margin-left:2%;";break;case"-tag":s=e;r+="display:inline-block;";i+="margin-left:2%;";break;case"-hang":s=this.generateTag("i",e);r+="width:8%;display:inline-block;";i+="margin-left:2%;";break;case"-ohang":s=this.generateTag("strong",e);r+="display:block;";i+="display:inline-block";break;case"-inset":s=this.generateTag("i",e);i+="display:inline-block;";break;case"-compact":r+="margin-bottom: 0;";i+="margin-bottom:0;"}}return n+'<li><span style="'+r+'">'+s+'</span><span style="'+i+'">'},El:function(){this.buffer.lists.shift();return"</span></li></ul>"},Pp:function(){this.buffer.openTags.push("p");return"<p>"},Oo:function(){return"["},Oc:function(){return"]"},Aq:function(e){return this.generateTag("span","&lt;"+e+"&gt;")},Ao:function(){return this.generateTag("span","&lt;")},Ac:function(){return this.generateTag("span","&gt;")},Bq:function(e){return this.generateTag("span","["+e+"]")},Bo:function(){return this.generateTag("span","[")},Bc:function(){return this.generateTag("span","]")},Brq:function(e){return this.generateTag("span","{"+e+"}")},Bro:function(){return this.generateTag("span","{")},Brc:function(){return this.generateTag("span","}")},Dq:function(e){return this.generateTag("span","``"+e+"''")},Do:function(){return this.generateTag("span","``")},Dc:function(){return this.generateTag("span","''")},Eq:function(e){return this.generateTag("span","XX"+e+"XX")},Eo:function(){return this.generateTag("span","XX")},Ec:function(){return this.generateTag("span","XX")},Pq:function(e){return this.generateTag("span","("+e+")")},Po:function(){return this.generateTag("span","(")},Pc:function(){return this.generateTag("span",")")},Qq:function(e){return this.generateTag("span",'"'+e+'"')},Qo:function(){return this.generateTag("span",'"')},Qc:function(){return this.generateTag("span",'"')},Sq:function(e){return this.generateTag("span","`"+e+"'")},So:function(){return this.generateTag("span","`")},Sc:function(){return this.generateTag("span","'")},St:function(e){var t="";e=e;if(E[e]){t=this.generateTag("abbr",E[e])}return t},At:function(e){var t=" AT&amp;T UNIX",n;e=e.match(f.number);n=e?"Version "+e[0]:"";return this.generateTag("span",n+t)},Bx:function(e){var t,n;t="BSD";e=e;if(e==="-devel"){n=t+"(currently under development)"}else{n=e+t}return this.generateTag("span",n)},Nx:function(e){return this.generateTag("span","NetBSD "+e)},Fx:function(e){return this.generateTag("span","FreeBSD "+e)},Dx:function(e){return this.generateTag("span","DragonFly "+e)},Ox:function(e){return this.generateTag("span","OpenBSD "+e)},Osx:function(e){return this.generateTag("span","BSD/OS "+e)},Ux:function(){return this.generateTag("span","UNIX")},Pf:function(e){e=this.parseArguments(e);return e.shift()+e.shift()+e.join(" ")},Pa:function(e){e=e||"~";return this.generateTag("i",e)},Ql:function(e){return this.generateTag("span","`"+e+"'")},Rs:function(){this.buffer.references={authors:[],bookTitle:"",date:"",publisherName:"",journalName:"",issueNumber:"",optionalInformation:"",pageNumber:"",corporate:"",reportName:"",articleTitle:"",volume:""}},"%A":function(e){this.buffer.references.authors.push(e)},"%B":function(e){this.buffer.references.bookTitle+=" "+e},"%D":function(e){this.buffer.references.date+=" "+e},"%I":function(e){this.buffer.references.publisherName+=" "+e},"%J":function(e){this.buffer.references.journalName+=" "+e},"%N":function(e){this.buffer.references.issueNumber+=" "+e},"%O":function(e){this.buffer.references.optionalInformation+=" "+e},"%P":function(e){this.buffer.references.pageNumber+=" "+e},"%Q":function(e){this.buffer.references.corporate+=" "+e},"%R":function(e){this.buffer.references.reportName+=" "+e},"%T":function(e){this.buffer.references.articleTitle+=" "+e},"%V":function(e){this.buffer.references.volume+=" "+e},Re:function(){var e=[];this.buffer.references.authors=this.buffer.references.authors.join(" and ");for(var t in this.buffer.references){if(this.buffer.references[t]){e.push(this.buffer.references[t])}}return this.generateTag("p",e.join(", "))},Tn:function(e){return this.generateTag("small",e)},Sy:function(e){return this.generateTag("strong",e)},Va:function(e){return this.generateTag("i",e)},Li:function(e){return this.generateTag("span",e)},Bf:function(e){var t;e=this.parseArguments(e)[0];t=y[e]||"span";this.buffer.activeFontModes.push(t);return"<"+t+">"},Ef:function(){var e=this.buffer.activeFontModes.pop();return"</"+e+">"},Ss:function(e){return this.generateTag("h3",e)},Fn:function(e){var t,n,r,s;e=this.parseArguments(e);if(!e[0]){return""}s=this.buffer.functionType;t=s?this.generateTag("i",s):"";n=this.generateTag("strong",e[0]);r=e[1]||"";this.buffer.functionType="";return this.generateTag("span",t+n+"("+r+")")},Ft:function(e){this.buffer.functionType=e},Fo:function(e){this.buffer.functionArgs=[];this.buffer.functionName=e},Fa:function(e){this.buffer.functionArgs.push(e)},Fc:function(){var e=this.buffer.functionArgs.join(", "),t=this.buffer.functionName+' "'+e+'"';return p.doc.Fn.call(this,t)},Vt:function(e){var t=this.generateTag("i",e),n=this.isInsideOfSection("SYNOPSIS")?"<br>":"";return t+n},Em:function(e){return this.generateTag("i",e)}};var e=function(){};e.prototype.generate=function(e,t){var n,r;if(!e){return""}n=new T(e);r=n.buildAST();t=t||"doc";this.macros=c([p.defaults,p[t]]);l=t;this.buffer={style:{indent:8,fontSize:16},references:[],lists:[],openTags:[],fontModes:[],sectionTags:[],activeFontModes:[],section:""};return this.recurse(r)};e.prototype.recurse=function(e){return e.reduce(this.reduceRecursive.bind(this),"")};e.prototype.reduceRecursive=function(e,t){var n,r;if(h(t)){if(t.value==="Sh"||t.value==="SH"){e+=this.closeAllTags(this.buffer.fontModes);e+=this.closeAllTags(this.buffer.openTags)}n=this.macros[t.value]||this.undefMacro;r=t.nodes.length?this.recurse(t.nodes):"";e+=n.call(this,r,t)||""}else{e+=this.cleanQuotes(t.value)}return e};e.prototype.undefMacro=function(e,t){console.warn("Unsupported macro:",t.value);return e};e.prototype.cleanQuotes=function(e){return e.replace(f.wrappingQuotes,"$1")};e.prototype.generateTag=function(e,t){var n=e.split(">"),r=-1,s="",i="";while(n[++r]){s+="<"+n[r]+">"}while(n[--r]){i+="</"+n[r]+">"}return s+t+i};e.prototype.generateAlternTag=function(e,t,n){var r=-1,s="",i=t;n=this.parseArguments(n);while(n[++r]){i=i===e?t:e;s+=this.generateTag(i,n[r])}return s};e.prototype.closeTag=function(e){return"</"+e+">"};e.prototype.closeAllTags=function(e){return this.closeTagsUntil(e[0],e)};e.prototype.closeTagsUntil=function(e,t){var n="",r;if(t.indexOf(e)!==-1){while(r=t.pop()){n+=this.closeTag(r);if(r===e){break}}}return n};e.prototype.parseArguments=function(e){e=e.match(f.arguments)||[];return e.map(function(e){return this.cleanQuotes(e).trim()}.bind(this))};e.prototype.isInsideOfSection=function(e){return this.buffer.section.toLowerCase()===e.toLowerCase()};return{HTMLGenerator:e,Lexer:d,Token:g,TokenFactory:m,macros:p,patterns:f,Parser:T,COMMENT:n,MACRO:r,IMACRO:s,BREAK:i,TEXT:a,EMPTY:u,ESCAPE:o}});
